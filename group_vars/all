group_vars:
  openstack:

    images:
      - name: cirros-0.5.2
        download_url: "http://download.cirros-cloud.net/0.5.2/cirros-0.5.2-x86_64-disk.img"
        cpu_arch: "x86_64"
        distro: "cirros"
      - name: ubuntu-22.04
        download_url: "https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img"
        cpu_arch: "x86_64"
        distro: "ubuntu"
    servers:
      - name: vm1
        image: cirros-0.5.2
        # A variable 'ssh_public_key_pair_name' is optional.
        # A server will be created containing with ssh public key pair if you declared it.
        ssh_public_key_pair_name: default

        flavor: m1.tiny
        auth_ref: "default"
        timeout: 300
        nics:
          - net-name: private_net
        security_groups:
          - permit_all

      - name: vm2
        image: ubuntu-22.04
        ssh_public_key_pair_name: default
        flavor: m1.medium
        auth_ref: "default"
        timeout: 300
        nics:
          - net-name: private_net
        security_groups:
          - permit_all

    # Parameters below are constructed as dictionary.
    # "group_vars.openstack.auth.<name_of_auth>" for example.
    # And they will be refered from other sections.
    # "group_vars.openstack.auth.<name_of_auth>" will be refered from parameters "group_vars.openstack.servers.[].auth_ref" for example.
    auth:
      # Key "name" is a config name of authentications. It will be used to identify them.
      # Other under a key "parameters" follows an auth parameter of module openstack.cloud.server.
      # You can declare auth_url, username, password for example.
      # For more details, please refer to a document of it.
      default:
        auth_url: http://dev-controller01:5000
        username: openstack_operator
        password: secret
        project_name: default_project
        user_domain_name: Default
        project_domain_name: Default

    security_groups:
      - name: permit_all
        projects:
          - admin
        description: "Permit all packets"
        rules:
          # You can omit the name of the security group that these rules will be added.
          #
          # Permit all tcp rules.
          - protocol: tcp
            port_range_min: 1
            port_range_max: 65535
            remote_ip_prefix: 0.0.0.0/0
          # Permit ICMP
          - protocol: icmp
            port_range_min: -1
            port_range_max: -1
            remote_ip_prefix: 0.0.0.0/0

    flavors:
      - name: "m1.tiny"
        ram: 512
        vcpus: 1
        disk: 2
      - name: "m1.medium"
        ram: 2048
        vcpus: 2
        disk: 8

    rbacs:
      # network_name: Network name that
      - network_name: private
        project_name: myproject
        args:
          # project_id will be added after project_name was has converted
          action: "access_as_shared"
          object_type: "network"

    ssh_public_keys:
      default:
        value: "ssh-ed25519 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx tsutomu@arch"
